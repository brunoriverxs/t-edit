(ns tedit.core
  (:require [reagent.core :as reagent :refer [atom]]
            [clojure.string]
            [goog.dom :as g-dom]
            [goog.array :as g-array]
            [cljs.core.async :as async
             :refer [>! <! alts! chan sliding-buffer put! close!]])
  (:require-macros [cljs.core.async.macros :as am :refer [go go-loop alt!]]))

(enable-console-print!)

;; mouse events

(defn single-event-channel []
  (let [c (chan (sliding-buffer 1))]
    {:channel c
     :mult (async/mult c)}))

(def single-event-channels #{:mouse-move :mouse-down :mouse-up
                             :text-change :selection-change
                             :file-drag-over :file-drag-leave :file-drag-end
                             :file-loaded})

(defonce comms (into {} (map #(vector % (single-event-channel)) single-event-channels)))

(defn get-channel [channel-name]
  (get-in comms [channel-name :channel]))

(defn get-mult [mult-name]
  (get-in comms [mult-name :mult]))

;; state

(defonce config {:canvas-width 1170
                 :canvas-height 700
                 :shirt-dimensions [575 675]
                 :art [{:name "Decorative Art"
                        :d "M85.376,11.704C86.28500000000001,10.055,86.491,8.237,85.967,6.426000000000001C85.073,3.339000000000001,82.472,1.258000000000001,78.446,0.40600000000000147C74.979,-0.3259999999999985,70.617,-0.059999999999998554,66.479,1.1370000000000013C62.989,2.1480000000000015,59.709,3.4820000000000015,55.86,5.455000000000001C52.588,4.773000000000001,47.842,4.910000000000001,43.125,5.823000000000001C38.407,4.910000000000001,33.662,4.7730000000000015,30.39,5.455000000000001C26.54,3.4810000000000008,23.261000000000003,2.147000000000001,19.772,1.1370000000000013C15.633999999999999,-0.05999999999999872,11.271999999999998,-0.3269999999999986,7.804999999999998,0.40600000000000136C3.777999999999998,1.2580000000000013,1.1769999999999978,3.3390000000000013,0.28399999999999803,6.426000000000001C-0.239000000000002,8.238000000000001,-0.03300000000000197,10.055000000000001,0.874999999999998,11.704C2.195999999999998,14.104000000000001,5.016999999999999,16.124000000000002,8.417999999999997,17.109C11.518999999999998,18.006,15.860999999999997,18.397000000000002,18.754999999999995,16.802000000000003C20.048999999999996,16.089000000000002,20.899999999999995,15.057000000000002,21.280999999999995,13.737000000000004C22.272999999999996,10.309000000000005,19.219999999999995,7.346000000000004,15.842999999999996,6.298000000000004C13.365999999999996,5.546000000000004,10.704999999999997,5.635000000000003,9.060999999999996,6.527000000000004C8.110999999999997,7.044000000000004,7.485999999999996,7.798000000000004,7.203999999999996,8.772000000000004C6.826999999999996,10.076000000000004,7.610999999999996,11.199000000000003,8.192999999999996,11.600000000000003C8.526999999999996,11.829000000000002,8.874999999999996,11.950000000000003,9.089999999999996,11.986000000000002C9.077999999999996,11.984000000000002,9.081999999999997,11.986000000000002,9.084999999999996,11.986000000000002C9.098999999999995,11.991000000000003,9.118999999999996,11.997000000000002,9.143999999999995,12.002000000000002C9.705999999999994,12.116000000000003,10.260999999999996,12.027000000000003,10.664999999999996,11.759000000000002C10.944999999999995,11.573000000000002,11.124999999999996,11.318000000000001,11.184999999999995,11.022000000000002C11.245999999999995,10.725000000000001,11.178999999999995,10.420000000000002,10.993999999999994,10.139000000000003C10.725999999999994,9.735000000000003,10.248999999999995,9.437000000000003,9.684999999999995,9.323000000000002C9.121,9.207,8.565,9.295,8.161,9.563C8.058,9.631,7.976,9.712,7.899,9.796C7.859,9.552,7.858,9.27,7.946,8.964C8.844,5.86,14.396,7.296,15.501,7.6160000000000005C18.491,8.481,21.338,10.698,20.522,13.517C19.43,17.288999999999998,13.753999999999998,17.785,8.711999999999998,16.326C5.422999999999998,15.374,2.8279999999999976,13.541,1.5909999999999975,11.298000000000002C0.776,9.818,0.6,8.257,1.064,6.652C2.926,0.22,12.171,0.423,19.522,2.551C22.354999999999997,3.371,25.275,4.4990000000000006,28.656999999999996,6.072C26.752999999999997,6.797,25.487999999999996,7.946,25.078999999999997,9.36C24.695999999999998,10.677999999999999,25.266,11.818,26.011999999999997,12.116C26.386999999999997,12.276,26.775999999999996,12.254999999999999,27.071999999999996,12.056C27.087999999999994,12.046999999999999,27.104999999999997,12.036,27.122999999999994,12.023L27.128999999999994,12.019C27.146999999999995,12.004,27.151999999999994,11.999,27.151999999999994,11.999C27.399999999999995,11.81,27.466999999999995,11.515,27.466999999999995,11.197000000000001C27.466999999999995,11.13,27.355999999999995,11.058000000000002,27.355999999999995,10.983V10.985000000000001V10.983V10.96C27.355999999999995,10.956000000000001,27.429999999999996,10.946000000000002,27.429999999999996,10.946000000000002L27.458999999999996,10.760000000000002H27.415999999999997C27.241999999999997,10.760000000000002,26.907999999999998,10.192000000000002,26.526999999999997,10.192000000000002C26.212999999999997,10.192000000000002,25.935,10.330000000000002,25.747999999999998,10.553000000000003C25.702999999999996,10.274000000000003,25.712999999999997,9.941000000000003,25.817999999999998,9.578000000000003C26.211,8.217000000000002,27.566,7.140000000000002,29.630999999999997,6.543000000000003C31.129999999999995,7.259000000000003,32.589,7.991000000000003,33.976,8.696000000000003C30.567999999999998,10.283000000000003,29.089,11.961000000000004,29.589,13.689000000000004C29.770999999999997,14.310000000000004,30.166999999999998,14.790000000000003,30.772,15.117000000000004C32.888999999999996,16.260000000000005,36.992999999999995,15.263000000000005,39.25,14.566000000000004C40.448,14.195000000000004,41.717,13.722000000000005,43.125,13.127000000000004C44.533,13.723000000000004,45.803,14.195000000000004,46.999,14.566000000000004C49.257000000000005,15.262000000000004,53.36,16.259000000000004,55.478,15.117000000000004C56.082,14.790000000000004,56.480000000000004,14.309000000000005,56.660000000000004,13.689000000000004C57.160000000000004,11.960000000000004,55.682,10.282000000000004,52.274,8.695000000000004C53.661,7.990000000000004,55.120000000000005,7.257000000000004,56.620000000000005,6.541000000000004C58.68300000000001,7.139000000000004,60.040000000000006,8.213000000000005,60.43300000000001,9.574000000000003C60.543000000000006,9.956000000000003,60.54800000000001,10.298000000000004,60.495000000000005,10.583000000000004C60.309000000000005,10.337000000000003,60.017,10.177000000000003,59.685,10.177000000000003C59.123000000000005,10.177000000000003,58.665,10.634000000000004,58.665,11.198000000000004C58.665,11.706000000000003,59.047,12.140000000000004,59.554,12.205000000000004C59.767,12.245000000000003,60.010000000000005,12.215000000000003,60.243,12.115000000000004C60.984,11.818000000000003,61.553000000000004,10.678000000000004,61.172000000000004,9.360000000000003C60.76200000000001,7.946000000000003,59.49700000000001,6.797000000000002,57.594,6.072000000000003C60.975,4.499000000000002,63.896,3.3710000000000027,66.72800000000001,2.551000000000003C74.08000000000001,0.4230000000000027,83.32500000000002,0.22000000000000286,85.18700000000001,6.653000000000003C85.65200000000002,8.257000000000003,85.47400000000002,9.819000000000003,84.66000000000001,11.299000000000003C83.424,13.542000000000003,80.82800000000002,15.375000000000004,77.53900000000002,16.327C72.49700000000001,17.786,66.82200000000002,17.291,65.72900000000001,13.518C64.91400000000002,10.699000000000002,67.75900000000001,8.482000000000001,70.75000000000001,7.617000000000001C71.85400000000001,7.297000000000001,77.40500000000002,5.860000000000001,78.30400000000002,8.965000000000002C78.38400000000001,9.240000000000002,78.39100000000002,9.533000000000001,78.34000000000002,9.822000000000001C77.98100000000002,9.382000000000001,77.28300000000002,9.170000000000002,76.52800000000002,9.322000000000001C75.53500000000003,9.524000000000001,74.87500000000001,10.269,75.02600000000002,11.021C75.18000000000002,11.772,76.07800000000003,12.203000000000001,77.07000000000002,12.001000000000001L77.08400000000002,11.998000000000001C77.10500000000002,11.993,77.11700000000002,11.989,77.11700000000002,11.989C77.11800000000002,11.988000000000001,77.12100000000002,11.988000000000001,77.12100000000002,11.987L77.08100000000002,11.994C77.29600000000002,11.975,77.68000000000002,11.861,78.06000000000002,11.599C78.64200000000001,11.198,79.42500000000001,10.075,79.04800000000002,8.771C78.76700000000001,7.797000000000001,78.14200000000001,7.042000000000001,77.19000000000001,6.526000000000001C75.54700000000001,5.634,72.88500000000002,5.546000000000001,70.41100000000002,6.297000000000001C67.03200000000001,7.346,63.97700000000002,10.309000000000001,64.97100000000002,13.736C65.35300000000002,15.056000000000001,66.20300000000002,16.089000000000002,67.49800000000002,16.801000000000002C70.39100000000002,18.396,74.73400000000002,18.005000000000003,77.83400000000002,17.108C81.234,16.124,84.054,14.104,85.376,11.704ZM31.522,6.013C34.149,5.628,37.534,5.716,41.102999999999994,6.266C40.577999999999996,6.394,40.065999999999995,6.527,39.581999999999994,6.668C38.01599999999999,7.12,36.596999999999994,7.604,35.352999999999994,8.104C34.19,7.455,32.875,6.728,31.522,6.013ZM39.025,13.832C35.455,14.957,32.504,15.189,31.131999999999998,14.455C30.698999999999998,14.223,30.429,13.904,30.307999999999996,13.482C29.891999999999996,12.046,31.417999999999996,10.584,34.840999999999994,9.136L35.044,9.238999999999999C37.485,10.482999999999999,39.802,11.655999999999999,42.089,12.671999999999999C40.999,13.144,39.988,13.528,39.025,13.832ZM36.23,8.591C37.294999999999995,8.196,38.477999999999994,7.81,39.842999999999996,7.414C40.87,7.117,41.968999999999994,6.853,43.126,6.6209999999999996C44.281,6.853,45.378,7.116999999999999,46.384,7.409C47.769,7.808,48.953,8.196,50.019,8.591C47.634,9.92,45.37,11.174,43.123999999999995,12.213C40.88,11.174,38.614,9.92,36.23,8.591ZM55.942,13.482C55.819,13.904,55.549,14.222,55.118,14.455C53.746,15.189,50.796,14.957,47.224000000000004,13.832C46.261,13.528,45.25000000000001,13.144,44.161,12.672C46.447,11.656,48.763000000000005,10.484,51.205,9.239L51.408,9.136000000000001C54.83,10.584,56.357,12.047,55.942,13.482ZM50.896,8.104C49.654,7.603999999999999,48.234,7.1209999999999996,46.667,6.667999999999999C46.183,6.525999999999999,45.671,6.393999999999999,45.146,6.265999999999999C48.715,5.715999999999999,52.101,5.627999999999999,54.726,6.012999999999999C53.392,6.72,52.108,7.427,50.896,8.104Z"}
                       {:name "Cross"
                        :d "M59.405,21.782L35.148,21.782L35.148,0L24.258,0L24.258,21.782L0,21.782L0,32.673L24.258,32.673L24.258,100L35.148,100L35.148,32.673L59.405,32.673Z"}
                       {:name "Power"
                        :d "M0,53.572C-0.016,40.7,5.321,30.962,10.48,24.78L10.48,24.78C15.667000000000002,18.547,20.704,15.544,21.156,15.264000000000001L21.156,15.264000000000001C24.523999999999997,13.271,28.852999999999998,14.415000000000001,30.823,17.819000000000003L30.823,17.819000000000003C32.789,21.211000000000002,31.674,25.566000000000003,28.334,27.569000000000003L28.334,27.569000000000003L28.335,27.570000000000004C28.335,27.570000000000004,28.331,27.571000000000005,28.32,27.578000000000003L28.32,27.578000000000003C28.311,27.582000000000004,28.297,27.592000000000002,28.278,27.604000000000003L28.278,27.604000000000003C28.209999999999997,27.646000000000004,28.084,27.729000000000003,27.910999999999998,27.848000000000003L27.910999999999998,27.848000000000003C27.56,28.082000000000004,27.014999999999997,28.473000000000003,26.339,29.01L26.339,29.01C24.99,30.083000000000002,23.137,31.75,21.311,33.955L21.311,33.955C17.642,38.422,14.145,44.753,14.129,53.56999999999999L14.129,53.56999999999999C14.132,62.459999999999994,17.676,70.45299999999999,23.442999999999998,76.29299999999999L23.442999999999998,76.29299999999999C29.223,82.12299999999999,37.129999999999995,85.70899999999999,45.922,85.71099999999998L45.922,85.71099999999998C54.714999999999996,85.70899999999999,62.620999999999995,82.12299999999999,68.401,76.29299999999998L68.401,76.29299999999998C74.17,70.45299999999997,77.714,62.45999999999998,77.716,53.56999999999998L77.716,53.56999999999998C77.69999999999999,45.02299999999998,74.422,38.827999999999975,70.87899999999999,34.375999999999976L70.87899999999999,34.375999999999976C67.50599999999999,30.154999999999976,63.89799999999999,27.803999999999977,63.53799999999999,27.584999999999976L63.53799999999999,27.584999999999976C63.53399999999999,27.581999999999976,63.52899999999999,27.580999999999975,63.52599999999999,27.578999999999976L63.52599999999999,27.578999999999976C63.52099999999999,27.575999999999976,63.51799999999999,27.573999999999977,63.514999999999986,27.572999999999976L63.514999999999986,27.572999999999976C63.511999999999986,27.569999999999975,63.506999999999984,27.569999999999975,63.506999999999984,27.569999999999975L63.506999999999984,27.569999999999975L63.506999999999984,27.569999999999975C60.170999999999985,25.564999999999976,59.05599999999998,21.209999999999976,61.01999999999998,17.817999999999977L61.01999999999998,17.817999999999977C62.99199999999998,14.413999999999977,67.31999999999998,13.269999999999976,70.68699999999998,15.262999999999977L70.68699999999998,15.262999999999977C71.14099999999998,15.541999999999977,76.17799999999998,18.544999999999977,81.36499999999998,24.778999999999975L81.36499999999998,24.778999999999975C86.52699999999999,30.961999999999975,91.86099999999998,40.69899999999998,91.84599999999998,53.57099999999998L91.84599999999998,53.57099999999998C91.843,79.208,71.283,99.991,45.924,100L45.924,100C20.565,99.991,0.006,79.208,0,53.572L0,53.572ZM38.859,50.001V28.570999999999998V7.143C38.859,3.199,42.022,0,45.925,0L45.925,0C49.824,0,52.988,3.199,52.988,7.143L52.988,7.143V28.571V50.001000000000005H52.99C52.99,53.941,49.825,57.14300000000001,45.926,57.14300000000001L45.926,57.14300000000001C42.022,57.143,38.859,53.941,38.859,50.001L38.859,50.001Z"}
                       {:name "Antelope"
                        :scale 0.27
                        :d "M52.39,162.713C43.71,174.25799999999998,34.863,183.652,30.538,198.374C29.376,202.329,27.981,204.65699999999998,22.403,207.915C16.825,211.173,11.710999999999999,215.362,9.155,219.31799999999998C6.597999999999999,223.27399999999997,6.597999999999999,225.36899999999997,6.597999999999999,225.36899999999997C11.398,222.66599999999997,11.565999999999999,229.87699999999998,6.673999999999999,236.57799999999997C4.090999999999998,240.11499999999998,-0.7140000000000013,243.65699999999998,0.08999999999999897,235.60899999999998C0.5539999999999989,230.95499999999998,4.913999999999999,220.21299999999997,7.991999999999999,215.36199999999997C19.741999999999997,196.84899999999996,33.682,176.78399999999996,50.007999999999996,160.79899999999998C53.309,157.568,54.999,159.243,52.39,162.713L52.39,162.713ZM43.157,189.059C48.693,189.029,50.55199999999999,184.149,51.247,180.661C51.848,177.654,52.046,177.412,49.818,178.89600000000002C47.81,180.236,32.687,189.11,43.157,189.059L43.157,189.059ZM65.483,151.48C71.75800000000001,149.26999999999998,65.25,156.426,67.691,156.833S72.65,158.015,74.78,155.088C76.348,152.934,86.393,136.898,97.855,123.431C127.346,88.78299999999999,170.276,44.459999999999994,210.563,21.49799999999999C211.411,21.01499999999999,210.743,19.68899999999999,209.85,20.08099999999999C193.733,27.16499999999999,163.99699999999999,45.17699999999999,144.507,63.20699999999999C144.162,63.52399999999999,143.637,63.05299999999998,143.92000000000002,62.676999999999985C151.263,52.95299999999999,182.959,19.412999999999982,214.13600000000002,1.4879999999999853C214.96600000000004,1.0109999999999855,214.33500000000004,-0.2930000000000146,213.44700000000003,0.06099999999998529C166.489,18.812,88.558,94.974,64.734,147.991C64.14,149.314,62.555,152.511,65.483,151.48L65.483,151.48ZM36.198,233.049C36.198,233.049,43.52,229.09300000000002,47.354,228.62800000000001C51.189,228.162,57.232,225.603,62.229,220.83100000000002C67.226,216.06000000000003,72.804,211.639,76.756,211.639C80.707,211.639,85.821,215.013,86.402,218.27200000000002C86.983,221.53000000000003,91.631,223.043,92.213,223.508C90.624,216.43800000000002,95.654,200.649,107.56899999999999,190.538C110.52399999999999,188.031,112.80299999999998,189.71900000000002,109.91899999999998,192.708C103.04599999999998,199.831,95.86799999999998,212.478,96.83599999999998,222.64C97.00699999999999,224.44199999999998,97.50599999999999,227.37699999999998,98.95499999999998,229.20899999999997C101.16299999999998,232.00199999999998,110.29299999999998,247.25099999999998,114.47499999999998,268.16299999999995S122.58099999999997,309.3829999999999,129.55399999999997,315.20099999999996C129.55399999999997,315.20099999999996,133.03999999999996,316.597,135.36499999999998,313.80499999999995C137.689,311.01199999999994,143.26799999999997,304.72799999999995,149.31099999999998,302.16799999999995C149.31099999999998,302.16799999999995,148.84699999999998,323.34599999999995,150.24099999999999,329.16399999999993C151.636,334.9819999999999,157.67899999999997,341.49799999999993,159.771,345.2219999999999C161.387,348.0979999999999,165.152,354.9319999999999,167.15699999999998,359.87799999999993C167.47799999999998,360.6689999999999,168.67399999999998,360.4439999999999,168.68699999999998,359.5919999999999C168.73499999999999,356.51499999999993,168.415,351.97799999999995,166.743,347.08399999999995C166.743,347.08399999999995,173.076,352.89799999999997,177.17,358.6089999999999C180.176,362.80499999999995,186.003,360.3299999999999,190.99699999999999,361.16399999999993C197.57199999999997,362.2609999999999,202.439,368.9559999999999,211.219,364.07199999999995C214.357,362.32699999999994,214.00799999999998,359.30199999999996,210.406,354.7629999999999C207.54500000000002,351.15899999999993,204.90300000000002,347.84899999999993,203.937,346.6389999999999C203.70700000000002,346.3499999999999,203.703,345.9539999999999,203.92700000000002,345.6609999999999C205.50900000000001,343.5889999999999,211.65300000000002,335.4269999999999,214.47400000000002,329.97699999999986C217.728,323.69399999999985,220.63400000000001,319.85399999999987,223.88700000000003,320.43599999999986C227.14100000000002,321.01799999999986,233.997,324.27599999999984,238.18200000000002,323.46099999999984C242.366,322.6469999999998,258.985,314.61699999999985,274.789,302.7479999999998C274.789,302.7479999999998,282.575,296.9309999999998,287.224,302.04999999999984C291.873,307.16999999999985,298.3,314.26799999999986,301.089,319.15499999999986S305.04,325.20599999999985,309.457,325.4379999999999C313.873,325.6699999999999,322.008,328.69599999999986,328.516,337.0749999999999C335.02500000000003,345.45299999999986,335.954,344.05599999999987,341.29900000000004,343.12599999999986C343.84700000000004,342.6829999999999,346.55300000000005,339.91299999999984,349.367,335.8249999999999C360.76500000000004,319.26999999999987,366.921,299.7359999999999,361.288,279.59199999999987C359.661,273.77499999999986,355.942,260.9739999999999,355.942,260.9739999999999S366.214,266.51299999999986,373.099,274.6699999999999C374.747,276.6229999999999,375.34,277.1179999999999,377.882,276.9539999999999C378.805,276.89499999999987,378.788,276.5229999999999,378.216,275.2789999999999C374.404,266.9949999999999,369.878,259.63599999999985,362.892,253.60599999999988C339.649,233.54599999999988,303.44,238.56399999999988,282.233,244.92499999999987C282.233,244.92499999999987,258.55400000000003,253.52599999999987,246.93200000000002,253.29299999999986C234.615,253.04699999999985,224.287,249.16599999999985,212.12400000000002,251.63899999999987C208.18600000000004,252.43999999999986,204.07700000000003,253.29299999999986,201.60800000000003,253.29299999999986C196.84400000000002,253.29299999999986,192.96000000000004,250.69399999999987,188.49500000000003,250.15499999999986C181.09700000000004,249.26099999999985,178.71700000000004,249.27299999999985,173.03100000000003,243.21299999999985C165.63900000000004,235.33699999999985,154.30100000000004,220.44999999999985,147.21900000000002,209.54099999999985C138.15500000000003,195.57799999999986,122.34900000000002,178.12299999999985,114.67900000000003,171.60699999999986C108.44800000000004,166.31299999999985,104.81900000000003,164.85899999999987,102.10600000000002,164.12599999999986C96.51300000000002,162.61399999999986,94.83000000000003,160.23399999999987,95.33400000000002,154.76499999999987C95.86500000000002,149.01399999999987,97.35900000000002,137.19699999999986,96.78200000000001,136.23399999999987C95.56800000000001,134.20799999999986,84.59300000000002,145.96099999999987,85.16000000000001,148.79999999999987C85.39200000000001,149.96399999999986,88.53000000000002,146.93999999999986,91.668,143.79699999999985C89.48700000000001,149.80799999999985,90.293,162.72499999999985,86.09,165.32299999999987C82.069,167.80999999999986,88.812,174.99399999999986,78.42,178.82199999999986C74.002,180.44899999999987,71.018,181.42199999999985,69.104,186.10199999999986C65.502,194.90999999999985,63.197,202.87299999999988,55.486999999999995,209.08199999999985C53.074,211.02399999999986,51.71399999999999,212.09399999999985,52.620999999999995,213.72899999999984C53.782999999999994,215.82399999999984,57.26899999999999,213.49699999999984,59.82599999999999,212.79699999999985C59.24499999999999,214.65899999999985,49.36699999999999,221.87399999999985,44.95099999999999,224.20099999999985C40.535,226.52799999999985,36.117999999999995,229.08799999999985,34.49199999999999,230.25099999999986C29.438,233.869,32.192,235.647,36.198,233.049L36.198,233.049ZM214.993,345.927C220.31799999999998,352.43100000000004,225.596,353.93100000000004,219.12,362.793C214.746,368.778,234.639,356.481,227.25400000000002,349.761C225.20300000000003,347.894,219.40900000000002,345.65200000000004,215.81900000000002,344.65700000000004C215.079,344.454,214.507,345.333,214.993,345.927L214.993,345.927ZM99.767,356.161C100.966,353.477,102.292,351.687,104.235,350.097C110.252,345.169,93.26,349.553,94.305,360.816C94.697,365.03799999999995,98.64800000000001,370.16999999999996,100.849,372.29999999999995C102.852,374.23699999999997,105.476,374.87199999999996,103.474,370.73599999999993C100.967,365.558,98.176,360.714,99.767,356.161L99.767,356.161ZM134.399,352.903C135.968,351.332,135.63,348.51000000000005,131.842,350.692C125.67900000000002,354.241,121.07100000000001,355.707,114.17700000000002,356.277C104.74900000000002,357.058,109.41600000000003,366.048,110.22600000000003,369.426C110.92300000000003,372.335,114.64300000000003,384.087,114.52600000000002,398.74899999999997C114.38000000000002,417.23299999999995,120.77000000000002,422.65999999999997,120.40700000000002,410.38899999999995C120.00300000000003,396.71599999999995,115.42300000000003,383.3539999999999,116.15300000000002,368.37799999999993C116.682,357.521,125.927,360.955,134.399,352.903L134.399,352.903ZM119.174,429.702C122.71100000000001,435.222,118.423,438.196,124.869,438.196C128.588,438.196,129.75,437.382,134.398,441.92C139.047,446.458,140.674,444.829,140.674,441.571C140.674,438.312,140.55700000000002,435.40400000000005,140.55700000000002,435.40400000000005S145.555,435.4030000000001,148.46,437.61400000000003C148.46,437.61400000000003,148.227,453.67300000000006,147.181,455.302C146.13600000000002,456.93100000000004,140.441,455.76800000000003,136.49,451.113C132.53900000000002,446.459,130.824,442.158,126.61200000000001,443.084C121.84700000000001,444.13100000000003,116.73400000000001,444.48,116.501,439.478C116.35600000000001,436.351,116.574,431.61,116.842,428.437C117.366,422.252,117.701,427.402,119.174,429.702L119.174,429.702ZM167.676,387.278C166.71699999999998,398.05,162.536,404.95300000000003,156.41699999999997,413.432C152.87499999999997,418.341,153.13199999999998,422.966,154.56299999999996,429.016C155.05299999999997,431.09000000000003,153.70899999999995,432.887,151.83199999999997,430.284C150.32099999999997,428.18899999999996,146.83399999999997,422.372,148.34599999999998,416.554C150.75499999999997,407.275,159.88899999999998,404.59099999999995,165.37499999999997,387.077C166.508,383.456,168.007,383.556,167.676,387.278L167.676,387.278ZM206.217,370.499C209.311,370.13100000000003,209.764,369.935,207.847,373.499C207.03400000000002,375.012,200.758,385.25100000000003,198.898,387.113C197.039,388.975,181.617,409.688,180.22299999999998,412.713C177.97099999999998,417.6,177.38799999999998,418.74600000000004,179.402,420.326C184.944,424.678,191.83599999999998,427.389,198.49599999999998,429.411C201.433,430.302,199.987,431.858,197.683,431.484C189.37699999999998,430.133,181.982,428.912,174.055,425.005C168.961,422.493,164.612,420.455,167.81,414.105C173.543,402.713,182.623,392.992,188.09,381.29600000000005C193.834,369.005,192.695,372.112,206.217,370.499L206.217,370.499ZM304.696,334.405C304.91400000000004,330.227,301.62,329.525,298.261,332.88899999999995C279.46000000000004,351.70799999999997,257.574,363.11999999999995,233.78900000000004,373.924C230.47600000000006,375.428,229.28300000000004,377.895,234.29100000000005,376.674C253.28500000000005,372.048,269.10100000000006,362.51599999999996,286.6700000000001,354.772C298.5200000000001,349.549,304.9960000000001,352.33799999999997,304.4030000000001,346.46999999999997C304.006,342.519,304.489,338.359,304.696,334.405L304.696,334.405ZM276.297,423.651C276.079,424.233,274.77200000000005,424.678,273.112,425.243C264.362,428.222,255.961,432.288,247.24300000000002,435.404C234.872,439.826,236.69200000000004,435.86,244.84300000000002,432.05C256.165,426.757,267.15700000000004,420.836,278.23900000000003,415.069C278.869,414.74,279.58700000000005,415.358,279.357,416.03000000000003C278.466,418.637,277.123,421.445,276.297,423.651L276.297,423.651ZM201.428,444.411C205.825,444.97,208.279,444.375,214.703,446.69C217.608,447.738,224.93,452.508,227.02100000000002,452.741C229.114,452.974,235.73800000000003,450.298,238.062,449.36699999999996C242.872,447.43999999999994,247.775,458.08,252.35600000000002,454.953C254.91400000000002,453.207,258.05100000000004,450.996,258.05100000000004,449.599S253.40200000000004,440.407,251.89100000000005,438.19599999999997C250.05000000000004,435.50199999999995,244.03700000000003,437.53799999999995,245.03500000000005,439.825C246.47900000000004,443.14,245.81200000000004,445.656,245.61600000000004,447.156C241.37900000000005,441.428,235.53500000000005,445.593,230.74100000000004,445.87600000000003C228.76400000000004,445.99300000000005,224.58100000000005,444.59700000000004,221.90800000000004,443.20000000000005C218.63300000000004,441.48800000000006,205.55100000000004,441.45400000000006,202.11600000000004,441.45400000000006C198.559,441.454,195.896,443.707,201.428,444.411L201.428,444.411ZM205.406,454.021C204.36,455.185,202.965,456.581,202.84900000000002,457.512C202.733,458.443,205.75500000000002,459.025,208.19500000000002,459.025S218.65400000000002,456.92999999999995,220.51300000000003,456S223.18600000000004,453.439,221.79100000000003,453.091S215.40000000000003,449.483,214.35300000000004,449.25100000000003C213.70000000000005,449.105,211.04800000000003,449.32300000000004,209.15200000000004,449.50800000000004C205.494,449.862,207.749,451.416,205.406,454.021L205.406,454.021ZM249.51,460.683C250.43599999999998,459.777,250.608,457.602,248.057,458.55899999999997C247.535,458.755,246.53699999999998,459.55499999999995,245.261,460.527C231.712,470.835,219.365,480.536,205.17399999999998,488.465C200.54199999999997,491.053,197.96899999999997,492.654,196.92299999999997,495.796S197.50399999999996,501.847,195.87699999999998,503.592C194.25099999999998,505.33799999999997,189.25199999999998,511.272,187.742,511.388C186.232,511.505,185.18599999999998,511.388,182.745,514.297C180.304,517.206,177.05,521.395,177.05,522.791C177.05,523.577,178.96200000000002,523.811,181.19400000000002,523.864C188.28000000000003,524.034,194.211,522.57,200.60100000000003,519.139C202.79500000000002,517.961,204.99600000000004,516.547,207.03400000000002,514.878C207.03400000000002,514.878,208.66100000000003,513.0160000000001,208.66100000000003,510.80500000000006C208.66100000000003,508.5950000000001,209.12600000000003,507.31500000000005,207.49800000000002,508.3620000000001C205.872,509.4100000000001,199.24800000000002,512.0860000000001,196.92300000000003,512.0860000000001C194.59900000000002,512.0860000000001,192.39000000000004,512.0860000000001,192.39000000000004,512.0860000000001S200.06100000000004,505.10500000000013,200.40900000000005,503.9400000000001C200.75800000000004,502.7770000000001,200.87400000000005,498.4720000000001,202.15300000000005,497.6570000000001C203.43100000000004,496.8430000000001,207.03400000000005,497.42500000000007,208.42800000000005,496.4930000000001L249.51,460.683L249.51,460.683ZM267.988,455.913C280.312,444.553,301.733,444.878,303.537,428.35900000000004C304.16799999999995,422.581,304.04299999999995,414.629,304.769,413.99300000000005C307.55400000000003,411.55400000000003,324.214,407.74700000000007,326.966,401.42600000000004C328.942,396.88800000000003,331.033,373.38300000000004,331.382,366.052C331.731,358.72200000000004,334.171,357.558,338.70300000000003,354.416S355.09000000000003,346.038,358.22700000000003,343.245C358.22700000000003,343.245,359.622,341.499,358.343,341.499C355.817,341.499,344.606,347.735,337.73900000000003,349.295C331.533,350.702,326.92400000000004,351.555,322.781,357.325C320.109,361.048,314.181,373.49899999999997,313.368,376.176S307.593,390.372,305.268,394.561C302.94399999999996,398.75,300.61999999999995,402.707,300.61999999999995,408.757S297.59899999999993,417.833,295.27399999999994,421.092C286.73299999999995,433.06399999999996,276.42099999999994,443.538,266.06899999999996,453.905C263.452,456.526,265.661,458.057,267.988,455.913L267.988,455.913ZM324.178,370.241C324.178,370.241,322.782,387.695,320.575,391.651C318.36699999999996,395.608,314.067,402.938,309.30199999999996,404.10200000000003C309.30199999999996,404.10200000000003,310.58,397.237,311.97499999999997,394.444L324.178,370.241L324.178,370.241ZM386.235,282.271C394.75800000000004,276.678,404.827,279.93600000000004,412.732,274.125C418.23600000000005,270.08,409.33500000000004,286.234,398.903,289.02C393.737,290.399,381.17400000000004,291.397,379.004,284.455C378.446,282.671,379.077,281.512,380.666,282.959C382.777,284.877,383.044,284.269,386.235,282.271L386.235,282.271Z"}
                       {:name "Phoenix"
                        :scale 0.24
                        :d "M176.27,169.153C193.282,171.236,198.98600000000002,168.119,214.33700000000002,163.512C233.044,157.9,241.61400000000003,182.999,239.835,199.65800000000002C238.49800000000002,212.18200000000002,231.594,217.75300000000001,222.262,207.14000000000001C212.456,195.99,202.797,190.109,188.858,185.185C160.2,175.061,129.982,169.179,110.271,134.71800000000002C109.408,148.93500000000003,113.58,160.27400000000003,118.469,171.20100000000002C64.642,134.382,51.021,90.362,67.615,31.261C43.532,66.474,30.433,99.235,43.453,142.918C24.557,131.814,11.283,114.896,0,95.776C9.847,145.35899999999998,42.251,183.25799999999998,84.036,209.326C70.552,208.976,57.682,205.548,45.093,200.718C62.45700000000001,219.577,81.53,233.873,102.483,243.761C92.41,245.142,81.888,244.733,70.918,242.53199999999998C87.557,255.75699999999998,105.11000000000001,267.46,128.71800000000002,269.17699999999996C113.14700000000002,275.50499999999994,101.57600000000002,287.38899999999995,93.46400000000003,301.972C125.99200000000002,273.971,169.68400000000003,309.90999999999997,209.52300000000002,284.95099999999996C198.46500000000003,300.479,182.15600000000003,313.17199999999997,163.19400000000002,313.24199999999996C182.63400000000001,343.59299999999996,241.48900000000003,303.18299999999994,233.69800000000004,376.69199999999995C231.55700000000004,363.38999999999993,224.40800000000004,349.71299999999997,214.02100000000004,341.06999999999994C229.07300000000004,367.61599999999993,224.92900000000003,392.48599999999993,222.05200000000005,414.43699999999995C221.60000000000005,407.26899999999995,220.13500000000005,398.99299999999994,216.51000000000005,392.68399999999997C201.75000000000006,457.943,166.69500000000005,499.44199999999995,123.81300000000005,528.755C109.04700000000004,538.849,80.67500000000004,549.492,66.23100000000005,534.622C60.74100000000005,528.9699999999999,58.425000000000054,520.762,62.18300000000005,513.6569999999999C65.01200000000004,508.3089999999999,70.84800000000004,504.9549999999999,77.36300000000006,507.2299999999999C84.67200000000005,509.7809999999999,88.86300000000006,519.7819999999999,80.76800000000006,527.699C90.19500000000005,523.982,93.42700000000006,515.1949999999999,91.54200000000006,507.496C87.65200000000006,491.608,67.28100000000006,488.97999999999996,55.77300000000006,499.017C45.39700000000006,508.066,44.85900000000006,526.114,56.85100000000006,538.249C67.18100000000007,548.7040000000001,83.60200000000006,551.74,97.72100000000006,550.374C141.89500000000007,546.096,187.89700000000005,498.42400000000004,206.05500000000006,467.30100000000004C189.47700000000006,539.09,133.64300000000006,564.3140000000001,70.17900000000006,577.874C140.34800000000007,572.7420000000001,197.33000000000004,549.395,225.02300000000005,472.79200000000003C225.17000000000004,507.302,215.21400000000006,532.895,190.89500000000004,553.802C183.73600000000005,559.956,173.79500000000004,569.607,170.52100000000004,580.009C167.69600000000005,588.987,169.05700000000004,597.918,177.41800000000003,603.125C194.57100000000003,613.807,214.88100000000003,594.994,198.67000000000004,580.276C207.25400000000005,595.351,180.15300000000005,599.626,180.57000000000005,582.9609999999999C180.98500000000004,566.3909999999998,200.19500000000005,559.6389999999999,212.89300000000006,545.4399999999999C256.0690000000001,497.155,240.97800000000007,441.2939999999999,263.79600000000005,402.4119999999999C255.96100000000004,406.7579999999999,249.74500000000006,413.48299999999995,244.82800000000006,420.8809999999999C251.41500000000005,394.3399999999999,264.75800000000004,373.63699999999994,287.16600000000005,360.1629999999999C275.5570000000001,362.8729999999999,265.41100000000006,368.6719999999999,258.33500000000004,377.9129999999999C281.50300000000004,311.8149999999999,354.85200000000003,328.3389999999999,383.254,292.09899999999993C367.619,296.9889999999999,352.945,294.63899999999995,343.322,280.6189999999999C374.171,289.40399999999994,413.577,232.6059999999999,436.165,258.1569999999999C430.92900000000003,235.8389999999999,402.25800000000004,233.48399999999992,385.92100000000005,240.27099999999993C436.37600000000003,211.36899999999991,453.91800000000006,178.8209999999999,452.485,126.08899999999993C442.65700000000004,150.38299999999992,424.13300000000004,167.73899999999992,401.165,177.61199999999994C430.183,147.40799999999993,425.51,100.18399999999994,456.1,78.98299999999993C434.95300000000003,85.98799999999993,420.41600000000005,101.23499999999993,408.821,117.76199999999994C413.687,97.26499999999994,415.959,75.46999999999994,413.60200000000003,51.35999999999994C409.307,65.56399999999994,405.216,79.22399999999995,395.84700000000004,89.07699999999994C403.898,59.98799999999994,400.27700000000004,26.492999999999938,395.45700000000005,0.0009999999999479314C392.81100000000004,16.782999999999948,388.19500000000005,33.126999999999946,378.86800000000005,48.96499999999995C362.18000000000006,26.806999999999945,350.55000000000007,14.930999999999948,326.4800000000001,3.0189999999999486C356.8930000000001,27.456999999999947,365.9070000000001,63.69599999999995,360.2080000000001,114.85599999999995C355.21600000000007,105.91099999999994,350.5590000000001,100.32399999999996,340.7510000000001,94.78399999999995C298.7190000000001,259.76699999999994,209.80200000000008,143.72099999999995,299.9190000000001,92.26499999999994C286.7030000000001,91.26399999999994,274.0580000000001,96.23099999999994,264.0620000000001,104.64899999999994C260.28700000000015,107.82799999999995,253.61400000000012,110.87099999999994,248.10800000000012,108.85499999999995C224.56200000000013,100.23099999999995,212.2770000000001,116.80299999999994,207.3680000000001,133.90499999999994C202.8360000000001,149.68999999999994,183.16200000000012,157.12799999999993,158.0830000000001,156.01199999999994C177.6590000000001,162.03199999999995,194.7200000000001,158.76299999999995,211.85200000000012,150.99099999999996C202.106,160.323,189.701,166.85,176.27,169.153L176.27,169.153ZM220.141,455.078C218.07399999999998,452.06699999999995,218.134,447.916,219.78699999999998,444.726C222.319,439.836,228.04299999999998,438.316,230.70399999999998,433.602C231.98099999999997,431.34099999999995,232.85799999999998,428.465,231.62699999999998,426.296C228.362,420.543,219.033,422.432,215.91799999999998,427.35699999999997C212.254,433.14899999999994,221.777,435.57399999999996,225.66799999999998,431.35699999999997C225.18499999999997,435.393,219.444,438.489,216.432,440.414C210.018,444.512,203.98999999999998,452.121,209.59199999999998,459.405C216.84199999999998,468.83099999999996,232.813,463.37699999999995,232.499,452.02599999999995C232.185,440.715,218.351,442.872,220.141,455.078L220.141,455.078ZM239.81,128.166C242.306,129.807,243.596,132.434,244.096,135.21699999999998C252.62,131.72199999999998,251.723,119.78399999999999,264.1,113.72099999999999C247.459,116.347,248.321,126.933,239.81,128.166L239.81,128.166ZM214.208,156.158C218.933,153.975,222.977,150.702,225.525,145.02999999999997C215.666,145.10099999999997,214.092,136.89499999999998,218.371,132.68799999999996C222.65,128.48199999999997,231.467,127.52999999999996,232.50300000000001,138.04999999999995C223.40800000000002,152.33199999999997,239.26000000000002,160.77299999999997,248.347,153.70499999999996C235.108,152.74999999999994,241.612,142.29299999999995,248.18,145.70999999999995C253.673,148.56699999999995,252.49800000000002,155.36399999999995,253.094,160.60699999999994C254.474,172.76599999999993,257.262,182.65899999999993,261.758,189.79699999999994C270.601,203.83599999999993,287.217,204.51699999999994,301.166,198.74999999999994C320.664,190.68799999999993,333.956,171.35699999999994,339.445,150.87499999999994C335.415,159.40399999999994,325.471,163.88599999999994,329.59499999999997,153.45499999999996C331.277,149.20199999999994,332.79499999999996,146.03899999999996,336.094,142.90999999999997C350.282,129.44899999999996,339.212,169.84799999999996,337.936,172.56499999999997C347.86499999999995,158.25199999999998,353.839,139.33299999999997,350.825,113.12099999999997C354.865,120.89199999999997,357.503,128.63499999999996,358.432,136.63499999999996C369.028,114.08599999999996,374.66900000000004,87.43199999999996,369.15200000000004,49.841999999999956C376.02600000000007,60.55099999999996,377.141,76.72499999999995,378.19000000000005,93.98699999999997C380.30000000000007,82.33999999999996,382.232,68.35299999999997,384.33400000000006,59.63299999999997C387.33400000000006,47.17799999999997,392.90100000000007,51.297999999999966,392.6310000000001,62.57099999999997C392.2940000000001,76.59199999999997,389.33600000000007,94.44799999999996,387.82400000000007,107.24399999999997C394.9030000000001,100.62999999999997,400.9150000000001,93.27399999999997,406.15100000000007,85.11399999999998C388.96700000000004,135.60199999999998,358.93300000000005,168.32799999999997,319.35800000000006,196.11199999999997C342.33700000000005,193.26599999999996,363.75800000000004,187.59199999999996,381.9460000000001,172.59799999999996C378.3080000000001,173.91999999999996,357.22300000000007,178.78399999999996,360.7080000000001,169.10599999999997C362.20900000000006,164.93599999999998,367.94200000000006,156.63499999999996,375.9000000000001,152.50399999999996C391.3090000000001,144.50499999999997,390.0230000000001,161.38899999999995,379.52600000000007,167.75699999999995C395.4680000000001,161.86499999999995,405.82500000000005,149.63699999999994,412.72100000000006,134.56099999999995C403.61800000000005,180.83599999999996,357.94100000000003,208.49099999999996,273.023,216.16699999999994C306.624,221.49799999999993,356.644,234.18099999999995,404.139,196.90199999999993C396.486,199.85299999999992,390.108,202.40299999999993,384.831,203.74899999999994C363.223,209.25799999999992,366.24800000000005,199.35199999999995,383.03700000000003,194.81399999999994C403.307,189.33499999999992,420.97200000000004,177.79399999999993,436.29,162.75999999999993C428.77200000000005,202.91099999999994,398.254,223.77599999999993,366.588,242.79799999999994C381.36100000000005,246.13099999999994,381.96200000000005,255.68799999999993,377.357,259.38599999999997C372.605,263.20199999999994,363.653,263.34599999999995,364.50300000000004,254.48099999999997C326.84900000000005,262.15299999999996,305.84800000000007,248.33299999999997,276.884,225.27399999999997C288.96700000000004,247.69199999999998,291.821,276.73299999999995,286.353,301.003C300.326,268.815,342.58,295.351,296.781,314.892C261.135,330.1,246.897,374.431,235.85500000000002,407.686C254.668,336.65599999999995,244.085,325.918,218.90200000000002,318.777C198.41600000000003,312.966,214.59300000000002,287.181,227.51000000000002,305.659C240.70200000000003,292.277,248.223,268.284,245.54700000000003,235.971C229.92100000000002,259.713,175.36300000000003,283.732,142.61300000000003,270.06100000000004C133.18000000000004,266.124,135.56700000000004,254.68600000000004,143.30100000000002,250.84600000000003C157.46400000000003,243.81700000000004,163.067,252.40900000000002,147.573,259.747C194.8,260.557,222.288,246.94500000000002,248.82600000000002,219.983C213.985,240.731,146.08300000000003,254.579,82.39400000000003,218.754C96.07900000000004,219.582,109.88800000000003,218.182,122.97700000000003,212.606C94.90200000000003,209.12199999999999,72.27800000000003,190.422,53.69900000000003,170.38299999999998C68.29400000000003,180.15699999999998,85.30600000000003,182.879,102.48100000000002,181.04C88.68900000000002,180.584,74.02900000000002,174.041,63.752000000000024,164.969C54.160000000000025,156.503,56.063000000000024,148.361,67.86900000000003,152.19C74.88100000000003,154.464,78.66300000000003,162.26,84.16800000000003,166.706C71.20500000000004,137.98899999999998,38.576000000000036,124.24799999999999,51.833000000000034,85.20899999999999C56.66700000000003,146.248,102.02900000000002,180.589,157.10300000000004,204.76C132.51800000000003,186.593,124.84100000000004,170.07799999999997,140.46100000000004,176.709C151.95100000000005,181.585,163.76500000000004,190.064,168.23200000000003,202.225C174.91900000000004,220.429,133.324,200.72799999999998,131.39800000000002,199.864C157.27100000000002,232.684,188.23000000000002,233.53300000000002,216.163,228.341C187.16000000000003,217.68900000000002,180.899,200.36200000000002,197.13,204.21800000000002C205.279,206.15200000000002,212.048,212.008,219.262,215.995C232.883,223.52,242.169,217.919,245.472,203.648C249.897,184.519,242.362,147.351,214.208,156.158L214.208,156.158ZM204.677,135.375C185.975,148.265,159.7,138.802,153.89,129.652C156.224,150.634,190.228,154.807,204.677,135.375L204.677,135.375Z"}
                       {:name "Xbox Controller"
                        :scale 0.36
                        :d "M300.111,86.508C251.096,37.493,176.039,5.329,167.87,6.35C159.639,7.377,122.932,19.146,117.833,44.642C112.728,70.165,110.176,73.743,87.197,96.72200000000001L86.22200000000001,97.697C63.24300000000001,120.676,59.66700000000001,123.22800000000001,34.14200000000001,128.333C8.645,133.433,-3.123,170.14,-4.153,178.368C-5.1739999999999995,186.53799999999998,26.993000000000002,261.591,76.00699999999999,310.61C100.81899999999999,335.421,116.524,337.112,125.99699999999999,327.825C135.647,318.368,139.09599999999998,297.286,138.839,275.34999999999997C138.584,253.39299999999997,144.008,237.51599999999996,152.022,224.60599999999997C156.024,218.15499999999997,160.678,212.43999999999997,165.584,207.08299999999997C170.496,201.72399999999996,175.665,196.71799999999996,180.70600000000002,191.67499999999998C185.74800000000002,186.63199999999998,190.78400000000002,181.439,196.185,176.48399999999998C201.587,171.527,207.359,166.81699999999998,213.873,162.755C226.899,154.63,242.894,149.088,264.849,149.343C286.787,149.60199999999998,307.868,146.15099999999998,317.327,136.50099999999998C326.613,127.023,324.923,111.32,300.111,86.508ZM42.509,207.278C30.947000000000003,207.278,21.571,197.905,21.571,186.339C21.571,174.778,30.946,165.402,42.509,165.402C54.073,165.402,63.447,174.777,63.447,186.339C63.447,197.903,54.073,207.278,42.509,207.278ZM157.643,26.315C163.825,26.315,168.834,31.326,168.834,37.507000000000005C168.834,43.68900000000001,163.822,48.70100000000001,157.643,48.70100000000001C151.46,48.70100000000001,146.451,43.68800000000001,146.451,37.50800000000001S151.461,26.315,157.643,26.315ZM110.926,102.511C121.69500000000001,102.511,130.421,111.24,130.421,122.006C130.421,132.775,121.693,141.501,110.92599999999999,141.501C100.15899999999999,141.501,91.43299999999999,132.772,91.43299999999999,122.006S100.159,102.511,110.926,102.511ZM114.248,220.759C99.894,220.759,88.254,209.11999999999998,88.254,194.767C88.254,180.412,99.894,168.773,114.248,168.773C128.604,168.773,140.24200000000002,180.412,140.24200000000002,194.767C140.242,209.12,128.604,220.759,114.248,220.759ZM146.45,72.226C146.45,66.044,151.46099999999998,61.034,157.642,61.034C163.823,61.034,168.833,66.04599999999999,168.833,72.226C168.833,78.408,163.821,83.418,157.642,83.418C151.461,83.419,146.45,78.409,146.45,72.226ZM180.366,149.585C168.80100000000002,149.585,159.42600000000002,140.21,159.42600000000002,128.64600000000002S168.80100000000002,107.70700000000002,180.366,107.70700000000002C191.93,107.70700000000002,201.306,117.08200000000002,201.306,128.64600000000002C201.307,140.21,191.931,149.585,180.366,149.585ZM192.361,83.419C186.179,83.419,181.16899999999998,78.408,181.16899999999998,72.228C181.16899999999998,66.04599999999999,186.182,61.035,192.361,61.035C198.54399999999998,61.035,203.554,66.047,203.554,72.228C203.554,78.409,198.544,83.419,192.361,83.419ZM192.361,48.702C186.179,48.702,181.16899999999998,43.689,181.16899999999998,37.509S186.182,26.317,192.361,26.317C198.54399999999998,26.317,203.554,31.328,203.554,37.509S198.544,48.702,192.361,48.702Z"}
                       {:name "Upload"
                        :d "M77.959,11.074C74.229,11.074,70.619,12.006,67.416,13.756C63.516,5.536,55.109,0,45.693,0C32.842999999999996,0,22.316999999999997,10.141,21.694999999999997,22.838C15.793999999999997,23.541,10.733999999999996,27.458000000000002,8.545999999999998,32.927C3.643,34.152,0,38.595,0,43.873C0,50.092999999999996,5.061,55.153999999999996,11.282,55.153999999999996H44.256C44.256,49.239,44.256,43.324,44.256,37.41C42.872,37.41,40.173,37.41,38.788,37.41C37.73,37.41,37.375,36.202,37.986,35.47C41.284,31.508,45.897999999999996,27.544999999999998,49.196,23.583C49.437999999999995,23.291999999999998,49.724,23.186,49.998999999999995,23.205C50.273999999999994,23.186,50.559999999999995,23.291999999999998,50.80199999999999,23.583C54.099999999999994,27.544999999999998,58.71499999999999,31.508,62.01199999999999,35.47C62.62199999999999,36.202,62.267999999999994,37.41,61.208999999999996,37.41C59.824,37.41,57.125,37.41,55.741,37.41C55.741,43.324,55.741,49.239,55.741,55.153999999999996H77.957C90.11099999999999,55.153999999999996,99.99799999999999,45.266999999999996,99.99799999999999,33.114S90.111,11.074,77.959,11.074Z"}
                       {:name "Headphones"
                        :d ["M12.628,82.881L16.265,82.94200000000001L16.565,79.284L18.402,78.979C18.402,78.979,20.013,76.638,21.772000000000002,76.532C23.531000000000002,76.42399999999999,23.080000000000002,77.276,23.080000000000002,77.276S28.220000000000002,72.667,34.491,77.658C34.491,77.658,35.342999999999996,78.109,35.866,84.039C36.387,89.969,37.56,112.521,36.004,130.683C36.004,130.683,35.94,138.09699999999998,31.688999999999997,138.135C27.438999999999997,138.17399999999998,23.717999999999996,137.164,23.717999999999996,137.164S21.171999999999997,138.10199999999998,19.589,138.052C18.006,138.00199999999998,17.407999999999998,137.19199999999998,17.407999999999998,137.19199999999998S10.447999999999997,136.84699999999998,8.094999999999997,128.59499999999997C5.742999999999997,120.34099999999997,3.022999999999997,100.26699999999997,5.416999999999997,88.39199999999997L6.585999999999997,84.27399999999997L5.73,77.495C10.634,76.28500000000001,9.973,78.37100000000001,11.459,77.72800000000001L12.628,82.881Z"
                            "M16.013,75.202C16.013,75.202,13.894000000000002,78.486,9.885000000000002,78.765C5.876000000000001,79.038,4.354000000000002,77.411,2.3640000000000017,74.186C0.375,70.96,-2.061,65.412,3.017,61.81L3.496,51.423C3.496,51.423,1.178,48.5,1.374,45.989000000000004C1.568,43.472,3.1790000000000003,33.756,7.401999999999999,30.547000000000004L8.344999999999999,30.579000000000004C8.344999999999999,30.579000000000004,21.289,-1.558999999999994,66.44999999999999,0.05800000000000338C111.60999999999999,1.6740000000000035,118.84699999999998,32.563,118.84699999999998,32.563S121.34299999999998,31.912000000000003,122.54499999999997,36.423C123.74599999999997,40.935,126.42099999999998,47.731,125.07899999999998,49.914C123.73499999999999,52.1,122.50399999999998,53.901,122.50399999999998,53.901S123.02499999999998,63.827000000000005,123.01299999999998,64.117C123.00199999999998,64.406,127.05199999999998,68.14500000000001,125.65599999999998,71.885C124.25799999999998,75.617,122.18699999999998,79.042,120.01099999999998,80.034C117.83399999999997,81.02000000000001,115.48699999999998,81.42500000000001,115.48699999999998,81.42500000000001S110.17699999999998,80.266,108.94099999999997,76.72400000000002C107.70699999999998,73.18300000000002,108.41599999999997,69.71200000000002,111.48199999999997,65.54800000000002C111.48199999999997,65.54800000000002,113.00699999999998,63.65900000000001,115.08499999999997,62.76400000000002C117.16099999999996,61.868000000000016,117.76599999999996,61.20900000000002,117.21699999999997,57.600000000000016C117.21699999999997,57.600000000000016,115.43399999999997,58.50700000000002,114.89299999999997,57.32200000000002C114.34999999999997,56.137000000000015,111.08299999999997,46.79300000000002,110.63099999999997,45.902000000000015C110.17599999999997,45.01400000000002,109.41999999999997,41.68800000000002,109.41999999999997,41.68800000000002L109.72499999999998,41.305000000000014C109.72499999999998,41.305000000000014,103.58499999999998,36.134000000000015,98.14699999999998,30.406000000000013C92.70899999999997,24.677000000000014,85.96499999999997,20.164000000000012,82.69999999999997,18.973000000000013C79.43199999999997,17.789000000000012,70.27799999999998,15.327000000000012,66.00499999999997,15.171000000000014C61.73199999999997,15.020000000000014,50.892999999999965,15.989000000000013,45.563999999999965,18.129000000000012C40.231999999999964,20.27100000000001,33.157999999999966,24.96800000000001,28.627999999999965,29.176000000000013C24.096999999999966,33.384000000000015,16.521999999999963,38.45200000000001,16.521999999999963,38.45200000000001S17.182999999999964,39.06200000000001,16.140999999999963,40.966000000000015C15.097999999999963,42.87000000000002,11.814999999999962,53.04400000000001,11.204999999999963,53.80000000000001C10.595999999999963,54.55700000000001,10.856999999999962,55.34200000000001,8.440999999999963,54.96200000000001C8.440999999999963,54.96200000000001,7.585999999999963,59.78900000000001,9.798999999999964,60.45200000000001C12.013999999999964,61.113000000000014,15.710999999999963,63.86500000000001,16.853999999999964,69.927C16.851,69.928,17.293,72.874,16.013,75.202Z"
                            "M115.479,84.323L112.081,84.16199999999999L111.84700000000001,80.51799999999999L110.13600000000001,80.10599999999998C110.13600000000001,80.10599999999998,108.662,77.68799999999997,107.02300000000001,77.47299999999998C105.37800000000001,77.25899999999999,105.79100000000001,78.12899999999999,105.79100000000001,78.12899999999999S101.05100000000002,73.24799999999999,95.132,77.80699999999999C95.132,77.80699999999999,94.33,78.20199999999998,93.766,84.03999999999999C93.205,89.877,91.825,112.142,93.04700000000001,130.216C93.04700000000001,130.216,93.01400000000001,137.561,96.983,137.862C100.952,138.161,104.44,137.388,104.44,137.388S106.803,138.477,108.28399999999999,138.525C109.76299999999999,138.57,110.329,137.804,110.329,137.804S116.83399999999999,137.895,119.136,129.866C121.435,121.83900000000001,124.232,102.12500000000001,122.146,90.22000000000001L121.107,86.07400000000001L122.435,77.46000000000001C122.435,77.46000000000001,117.283,79.63000000000001,116.64,79.289L115.479,84.323Z"]
                        :scale 0.8}
                       {:name "Speakers"
                        :scale 0.5
                        :d "M95.004,239.451V11.168C97.06400000000001,10.267999999999999,98.50200000000001,8.216999999999999,98.50200000000001,5.827999999999999C98.502,2.607,95.894,0,92.674,0H81.017C79.113,0,77.426,0.919,76.363,2.331H22.143C21.078,0.919,19.392,0,17.487,0H5.829C2.61,0,0,2.607,0,5.828C0,8.217,1.44,10.267,3.498,11.168V239.451C1.44,240.353,0,242.401,0,244.79C0,248.012,2.61,250.619,5.829,250.619H17.486C19.115000000000002,250.619,20.588,249.951,21.645,248.873H76.856C77.916,249.951,79.38499999999999,250.619,81.014,250.619H92.67C95.891,250.619,98.499,248.012,98.499,244.79C98.502,242.401,97.063,240.353,95.004,239.451ZM91.653,246.53H6.851C6.288,246.53,5.83,246.072,5.83,245.50900000000001C5.83,244.947,6.287,244.48800000000003,6.851,244.48800000000003H91.653C92.21600000000001,244.48800000000003,92.674,244.94600000000003,92.674,245.50900000000001C92.674,246.072,92.217,246.53,91.653,246.53ZM48.475,61.877C71.006,61.877,89.274,80.14500000000001,89.274,102.67699999999999C89.274,125.20899999999999,71.005,143.474,48.475,143.474C25.943,143.474,7.677,125.208,7.677,102.67699999999999C7.677,80.145,25.942,61.877,48.475,61.877ZM35.166,51.873V18.067H59.062V51.873H35.166ZM48.28,152.413C70.812,152.413,89.081,170.678,89.081,193.21S70.811,234.008,48.28,234.008S7.483,215.742,7.483,193.21S25.747,152.413,48.28,152.413ZM91.653,7.867H6.851C6.288,7.867,5.83,7.412,5.83,6.846C5.83,6.283,6.287,5.828,6.851,5.828H91.653C92.21600000000001,5.828,92.674,6.283,92.674,6.846C92.674,7.412,92.217,7.867,91.653,7.867Z"}
                       {:name "Woman leaning"
                        :scale 3.5
                        :d "M4.702,36.547C4.184,36.437,3.6710000000000003,36.029999999999994,3.6710000000000003,35.634S3.79,34.445,3.474,34.048C3.156,33.651,2.9170000000000003,33.451,3.196,33.015S3.7920000000000003,32.222,3.911,31.35C4.03,30.477,4.188,28.651000000000003,4.188,28.174C3.8709999999999996,28.293,3.671,28.256,3.671,27.977C3.671,27.699,3.4339999999999997,27.46,3.3939999999999997,27.858C3.3549999999999995,28.256,3.3549999999999995,28.413,2.8779999999999997,28.413C2.4019999999999997,28.413,2.1639999999999997,28.453,2.1639999999999997,28.176000000000002C2.1639999999999997,27.901000000000003,2.2039999999999997,27.699,1.7679999999999998,27.62C1.3299999999999998,27.542,1.0939999999999999,27.580000000000002,1.2919999999999998,27.025000000000002C1.4899999999999998,26.469,1.4109999999999998,26.469,1.2919999999999998,26.152C1.1729999999999998,25.834,1.0539999999999998,25.953,1.1729999999999998,25.556S1.529,22.539,1.529,21.905C1.529,21.272000000000002,1.648,19.486,1.648,18.929000000000002C1.2919999999999998,18.732000000000003,1.133,18.413000000000004,1.133,18.097C1.133,17.779,1.211,16.786,1.014,16.271C0.8160000000000001,15.756,0.30000000000000004,14.328000000000001,0.14100000000000001,13.772S-0.017999999999999988,11.907,0.02100000000000002,11.232C0.06100000000000002,10.558,0.377,7.543999999999999,0.458,7.065999999999999C0.537,6.588999999999999,0.815,5.676999999999999,1.054,5.359999999999999C1.291,5.042999999999999,1.609,4.763999999999999,1.927,4.805C2.243,4.843999999999999,3.037,4.883,3.435,4.843999999999999C3.831,4.805,4.07,4.526999999999999,4.427,4.169C4.348,3.5729999999999995,4.268999999999999,2.6999999999999993,4.427,2.3439999999999994C4.585,1.986,4.783,1.59,4.902,1.232C5.021,0.877,5.498,0.399,5.696,0.242C5.895,0.08199999999999999,6.49,-0.11399999999999999,6.8069999999999995,0.08199999999999999C7.124,0.28,7.917,0.9159999999999999,8.157,1.1540000000000001S8.99,2.224,8.831,2.4640000000000004C8.673,2.701,8.475,3.06,8.475,3.337C8.475,3.6130000000000004,8.635,4.367,8.475,4.648C8.316,4.924,8.119,4.924,8.316,5.36C8.515,5.798,8.832,6.035,8.754000000000001,6.272C8.675,6.511,8.397,6.868,8.236,7.106C8.078,7.345,8.039,7.662,8.039,7.94C7.84,7.78,7.683,7.464,7.84,7.306C7.999,7.146,8.318,6.511,8.278,6.353C8.237,6.194,8.079,5.956,7.921,5.718C7.764,5.479,7.366,4.765,7.247,4.806C7.128,4.845,6.851,4.964,6.612,5.161C6.374,5.359,6.136,5.439,5.897,5.638C5.937,6.273,6.055000000000001,6.511,6.055000000000001,6.71C6.612000000000001,7.066,7.085000000000001,7.425,7.165000000000001,7.701C7.245000000000001,7.978,7.323000000000001,9.051,7.323000000000001,9.286999999999999C7.323000000000001,9.524999999999999,7.245000000000001,10.437999999999999,7.2040000000000015,10.914C7.165000000000002,11.392,7.245000000000002,12.184999999999999,7.245000000000002,12.464C7.721000000000002,13.217,8.395000000000001,14.366,8.555000000000001,15.003C8.712000000000002,15.638,9.071000000000002,19.05,9.071000000000002,19.247C9.428,19.644,9.587000000000002,19.485,9.587000000000002,20.12C9.587000000000002,20.756,9.745000000000001,21.112000000000002,9.390000000000002,20.993000000000002C9.034000000000002,20.874000000000002,8.833000000000002,20.835,8.913000000000002,21.072000000000003C8.992000000000003,21.310000000000002,9.071000000000002,24.405,9.309000000000003,24.923000000000002C9.111000000000002,25.080000000000002,9.032000000000004,25.199,8.913000000000002,25.199C8.992000000000003,25.715000000000003,9.309000000000003,26.865000000000002,9.469000000000001,27.541C9.626000000000001,28.216,9.745000000000001,28.93,9.825000000000001,29.524S10.263000000000002,31.111,10.383000000000001,31.349C10.500000000000002,31.586,10.977,32.102,10.977,32.261S11.253,33.888000000000005,11.373000000000001,34.126000000000005C11.492,34.36300000000001,11.97,35.315000000000005,11.97,35.55500000000001C11.97,35.79200000000001,12.247,36.66400000000001,11.492,36.348000000000006C10.738000000000001,36.031000000000006,9.787,35.75200000000001,9.787,35.23700000000001C9.787,34.72200000000001,9.588000000000001,34.36500000000001,9.588000000000001,33.69100000000001C9.588000000000001,33.01500000000001,9.47,32.14200000000001,9.192,31.58700000000001C8.915000000000001,31.03100000000001,7.764,29.04800000000001,7.565,28.73100000000001C7.368,28.413000000000007,7.010000000000001,27.38200000000001,7.010000000000001,27.06500000000001C6.614000000000001,27.22300000000001,6.6530000000000005,27.10400000000001,6.3740000000000006,27.10400000000001C6.255000000000001,27.81800000000001,5.739000000000001,29.80200000000001,5.540000000000001,30.35800000000001C5.3420000000000005,30.914000000000012,4.945000000000001,32.10300000000001,4.905000000000001,32.381000000000014C4.866000000000001,32.658000000000015,4.866000000000001,33.21500000000002,4.985000000000001,33.77000000000002C5.104000000000001,34.326000000000015,5.262000000000001,34.643000000000015,5.4220000000000015,34.99900000000002C5.580000000000002,35.356000000000016,5.779000000000002,35.872000000000014,5.699000000000002,36.110000000000014C5.615,36.349,5.257,36.665,4.702,36.547ZM1.29,12.185C1.21,12.74,1.5670000000000002,13.733,1.964,15.716000000000001C2.003,15.359000000000002,2.241,12.978000000000002,2.241,12.659C2.241,12.344000000000001,2.043,12.064,1.566,10.756C1.448,11.193,1.369,11.629,1.29,12.185Z"}
                       {:name "Christmas tree"
                        :d "M29.748,13.058C29.748,13.057,29.748,13.054,29.748,13.052999999999999C24.588,19.616,19.32,26.63,15.566,34.304C16.361,34.576,18.179000000000002,34.737,18.968,34.96C16.32,38.046,12.484,41.335,10.447,45.123000000000005C11.418,45.39300000000001,14.296999999999999,45.95100000000001,15.261,46.176C11.917,50.117000000000004,7.340999999999999,54.281000000000006,4.893999999999998,58.731C5.873999999999999,59.34,8.207999999999998,59.963,9.418999999999999,60.249C5.32,63.815,2.701,68.628,0,73.916C17.695,83.88799999999999,40.512,84.163,59.496,73.916C56.848,68.884,54.377,64.194,49.963,60.147C51.172000000000004,59.862,53.518,59.245999999999995,54.604,58.614C52.102,54.089999999999996,47.739,50.018,44.522,46.169C45.485,45.943999999999996,47.867999999999995,45.388,48.824999999999996,45.122C46.87199999999999,41.59,43.215999999999994,38.468,40.379999999999995,35.125C41.166999999999994,34.902,43.376,34.344,44.15899999999999,34.075C40.488,26.537,35.027,19.71,29.748,13.058L29.748,13.058ZM26.916,27.805C28.221,27.805,29.283,28.868,29.283,30.172C29.283,31.475,28.221,32.538000000000004,26.916,32.538000000000004C25.613,32.538000000000004,24.551000000000002,31.475000000000005,24.551000000000002,30.172000000000004C24.551,28.869,25.613,27.805,26.916,27.805L26.916,27.805ZM46.732,62.8C48.016999999999996,62.8,49.068,63.849,49.068,65.134C49.068,66.42,48.016999999999996,67.468,46.732,67.468S44.397999999999996,66.42,44.397999999999996,65.134C44.398,63.849,45.447,62.8,46.732,62.8L46.732,62.8ZM19.143,66.391C20.985,66.391,22.487000000000002,67.89200000000001,22.487000000000002,69.733S20.985000000000003,73.07600000000001,19.143,73.07600000000001C17.303,73.07600000000001,15.801,71.57400000000001,15.801,69.733S17.303,66.391,19.143,66.391L19.143,66.391ZM16.438,50.118C17.558999999999997,50.118,18.471,51.031,18.471,52.151S17.559,54.184000000000005,16.438,54.184000000000005C15.318999999999999,54.184000000000005,14.406999999999998,53.27100000000001,14.406999999999998,52.151S15.318,50.118,16.438,50.118L16.438,50.118ZM31.045,51.255C32.582,51.255,33.836,52.509,33.836,54.045S32.582,56.835,31.044999999999998,56.835S28.253999999999998,55.581,28.253999999999998,54.045S29.508,51.255,31.045,51.255L31.045,51.255ZM38.348,37.354C39.793,37.354,40.975,38.534,40.975,39.979C40.975,41.425,39.793,42.605,38.348,42.605S35.723,41.425,35.723,39.979C35.723,38.534,36.902,37.354,38.348,37.354L38.348,37.354ZM29.748,0L31.988,4.748L37.195,5.412L33.373,9.008L34.352,14.165L29.747999999999998,11.642L25.145999999999997,14.165L26.124999999999996,9.008L22.302999999999997,5.411999999999999L27.509999999999998,4.747999999999999L29.748,0L29.748,0Z"}
                       {:name "Dollar"
                        :d "M49.973,100H49.97C36.614,99.992,24.061999999999998,94.787,14.622999999999998,85.342C5.181,75.89,-0.012,63.328,0,49.966C-0.012,36.631,5.177,24.082,14.614,14.639000000000003C24.049,5.201,36.594,0,49.94,0H50.001999999999995C63.354,0,75.909,5.201,85.35,14.638C94.789,24.077,99.991,36.623,100,49.97C99.991,63.339999999999996,94.784,75.89699999999999,85.339,85.344C75.893,94.787,63.335,99.992,49.973,100L49.973,100ZM49.94,11.494C39.667,11.494,30.008999999999997,15.497,22.743999999999996,22.767C15.481999999999996,30.037,11.485999999999997,39.695,11.493999999999996,49.967C11.485999999999997,60.265,15.485999999999997,69.939,22.755999999999997,77.215C30.022999999999996,84.492,39.687999999999995,88.498,49.971,88.504C71.204,88.494,88.491,71.209,88.50399999999999,49.97200000000001C88.49099999999999,28.759000000000007,71.22099999999999,11.495000000000012,50.00299999999999,11.495000000000012H49.94L49.94,11.494ZM54.323,44.643V33.436C57.517,33.666,60.011,36.837,60.306,40.073H70.91199999999999C70.92399999999999,29.19,61.02799999999999,23.469,54.21199999999999,23.048000000000002V15.704H44.097V23.048000000000002C41.120000000000005,23.071,27.707,26.865000000000002,27.722,39.037000000000006C27.706000000000003,49.87200000000001,37.379000000000005,52.828,44.097,53.77900000000001V66.019C39.203,64.632,38.308,60.86500000000001,37.624,57.751000000000005H26.853C27.543000000000003,69.93100000000001,38.246,75.60000000000001,44.097,76.464V83.968H54.324V76.57300000000001C62.411,76.13600000000001,71.99,69.153,72.003,59.60000000000001C71.988,48.612,62.447,45.497,54.323,44.643ZM44.151,42.845C36.949000000000005,42.733,36.806000000000004,34.841,44.151,33.543V42.845ZM54.434,66.074V55.521C63.354,55.765,64.346,64.66,54.434,66.074Z"}
                       ]
                 :fonts [["Helvetica Neue", "sans-serif"]
                         ["Permanent Marker" "cursive"]
                         ["Codystar" "cursive"]
                         ["Fredericka the Great" "cursive"]
                         ["Josefin Sans" "sans-serif"]
                         ["Anton" "sans-serif"]
                         ["Shadows Into Light" "cursive"]
                         ["Gloria Hallelujah" "cursive"]
                         ["Calligraffitti" "cursive"]
                         ["Tangerine" "cursive"]
                         ["Amatic SC" "cursive"]
                         ["Orbitron" "sans-serif"]
                         ["Damion" "cursive"]
                         ["Homemade Apple" "cursive"]
                         ["Spirax" "cursive"]
                         ["Sancreek" "cursive"]
                         ["Mountains of Christmas" "cursive"]]
                 :shirt-colors [["#ffffff" "White"]
                                ["#1a1a1a" "Black"]
                                ["#141525" "Navy"]
                                ["#d4cfc3" "Ash"]
                                ["#1a2f78" "Deep Royal"]
                                ["#9f0110" "Deep Red"]
                                ["#142510" "Deep Forest"]
                                ["#e54d09" "Orange"]
                                ["#4b256e" "Purple"]
                                ["#a7fc5c" "Lime"]]
                 :elem-colors ["rgb(175,175,175)"
                               "rgb(255,255,255)"
                               "rgb(220,36,31)"
                               "rgb(253,66,56)"
                               "rgb(192,54,44)"
                               "rgb(226,56,40)"
                               "rgb(159,45,32)"
                               "rgb(227,78,53)"
                               "rgb(112,50,34)"
                               "rgb(55,43,39)"
                               "rgb(78,38,20)"
                               "rgb(232,186,165)"
                               "rgb(255,82,0)"
                               "rgb(255,90,0)"
                               "rgb(240,208,187)"
                               "rgb(177,127,92)"
                               "rgb(205,88,6)"
                               "rgb(42,38,35)"
                               "rgb(251,195,153)"
                               "rgb(255,181,123)"
                               "rgb(192,114,47)"
                               "rgb(171,156,143)"
                               "rgb(231,111,0)"
                               "rgb(241,124,14)"
                               "rgb(152,143,134)"
                               "rgb(185,156,107)"
                               "rgb(202,179,136)"
                               "rgb(255,179,0)"
                               "rgb(218,214,203)"
                               "rgb(198,146,0)"
                               "rgb(170,157,113)"
                               "rgb(212,204,170)"
                               "rgb(245,211,18)"
                               "rgb(155,137,0)"
                               "rgb(250,230,0)"
                               "rgb(243,237,134)"
                               "rgb(202,202,200)"
                               "rgb(91,221,69)"
                               "rgb(47,137,39)"
                               "rgb(35,93,55)"
                               "rgb(67,217,199)"
                               "rgb(123,221,216)"
                               "rgb(0,175,173)"
                               "rgb(54,204,218)"
                               "rgb(102,207,230)"
                               "rgb(0,160,226)"
                               "rgb(66,180,230)"
                               "rgb(0,103,198)"
                               "rgb(0,35,76)"
                               "rgb(140,180,232)"
                               "rgb(0,48,130)"
                               "rgb(212,221,237)"
                               "rgb(59,96,175)"
                               "rgb(97,98,101)"
                               "rgb(170,148,222)"
                               "rgb(122,82,199)"
                               "rgb(74,33,126)"
                               "rgb(172,4,129)"
                               "rgb(230,83,188)"
                               "rgb(229,26,155)"
                               "rgb(250,159,204)"
                               "rgb(242,85,138)"
                               "rgb(248,119,158)"
                               "rgb(195,12,62)"
                               "rgb(250,175,194)"
                               "rgb(158,27,52)"
                               "rgb(210,16,52)"
                               "rgb(124,34,48)"]})

(defonce elems (atom {}))
(defonce transients (atom {}))
(defonce highlighted (atom nil))
(defonce selected (atom nil))
(defonce debug (atom {}))
(defonce id-counter (atom 0))
(defonce options (atom {:text-field ""
                        :shirt-color "#fff"
                        :shirt-color-preview "#fff"}))
(defonce active-options (atom :art))
(defonce bounding-boxes (atom {}))

;; util

(defn gen-id! [] (swap! id-counter inc) @id-counter)

(defn selected-elem [] (when @selected (assoc (@elems @selected) :id @selected)))
(defn highlighted-elem [] (when @highlighted (assoc (@elems @highlighted) :id @highlighted)))

(defn swap-selected-elem! [f & args]
  (if @selected
;    (apply (partial (swap! elems update-in [@selected])) args)
    (let [new-elem (apply (partial f (selected-elem)) args)]
      (swap! elems assoc @selected new-elem))
    (println "ERROR: No element selected")))

(def default-elem-props
  (atom {:x (/ (:canvas-width config) 4)
         :y 200
         :color "#333"
         :text ""
         :dragging false
         :highlight true}))

(def default-text-elem-props
  (atom {:text ""
         :type :text
         :font-size 25
         :font (first (config :fonts))}))

(def default-art-elem-props
  (atom {:type :art
         :scale 1}))

(defn create-elem! [props]
  (let [id (gen-id!)]
    (swap! elems assoc id props)
    (reset! selected id)))

(defn delete-elem! [id]
  (swap! elems dissoc id)
  (reset! selected nil))

(defn font->font-family-str [[font style]]
  (str "'" font "', " style))

;; dom manipulation/query

(defn get-element [id] (. js/document (getElementById (name id))))

(defn set-cursor! [cursor-type]
  (aset js/document "body" "style" "cursor" (name cursor-type)))

(defn children
  [el]
  (g-array/toArray (g-dom/getChildren el)))

(defn set-visible! [element-id visible?]
  (aset (get-element element-id) "style" "display" (if visible? "block" "none")))

;; js interop

(defn js-to-list [js-col]
  (-> (clj->js [])
      (.-slice)
      (.call js-col)
      (js->clj)))

;; drag fns

(defn mouse-delta [e mouse-start-state]
  [(- (.. e -pageX) (:x mouse-start-state))
   (- (.. e -pageY) (:y mouse-start-state))])

(defn drag-start [e]
  (reset! transients {:mouse-start-state {:x (.-pageX e) :y (.-pageY e)}
                      :elem-start-state (selected-elem)})
  (swap-selected-elem! merge {:dragging true})
  (swap! bounding-boxes dissoc @selected)
  (set-cursor! :move))

(defn transform-matrix [elem]
  [(:scale elem 1) 0 0 (:scale elem 1) (:x elem 0) (:y elem 0)])

(defn transform-str [& args]
  (str "matrix(" (clojure.string/join "," args) ")"))

(defn transform-matrix-str [elem]
  (apply transform-str (transform-matrix elem)))

(defn constrain [v min-v max-v]
  (cond (< v min-v) min-v
        (> v max-v) max-v
        :else v))

(defn e->translation [e {:keys [mouse-start-state elem-start-state]}]
  (let [[delta-x delta-y] (mouse-delta e mouse-start-state)]
    {:x (constrain (+ (:x elem-start-state) delta-x) 0 (:canvas-width config))
     :y (constrain (+ (:y elem-start-state) delta-y) 0 (:canvas-height config))}))

(defn dominant [f values]
  (apply (partial max-key Math/abs) values))

(defn e->scale [e {:keys [mouse-start-state elem-start-state]}]
  (let [deltas (mouse-delta e mouse-start-state)]
    #_(swap! debug merge {:font-size new-font-size :deltas (print-str deltas)
                        :dominant-delta (dominant Math/abs deltas)})
    (case (:type elem-start-state)
      :text {:font-size (max (+ (:font-size elem-start-state)
                                (dominant Math/abs deltas)) 10)}
      :art {:scale (max (+ (:scale elem-start-state)
                           (/ (dominant Math/abs deltas) 100)) 0.1)})))

(defn drag-move [e]
  (when (:dragging (selected-elem))
    (swap-selected-elem! merge (e->translation e @transients))))

(defn drag-end [e]
  (when (:dragging (selected-elem))
    (swap-selected-elem! merge (e->translation e @transients) {:dragging false})
    (set-cursor! :auto)))

(defn resize-start [e]
  (reset! transients {:mouse-start-state {:x (.-pageX e) :y (.-pageY e)}
                      :elem-start-state (selected-elem)})
  (swap-selected-elem! merge {:resizing true})
  (swap! bounding-boxes dissoc @selected)
  (set-cursor! :se-resize))

(defn resize-move [e]
  (when (:resizing (selected-elem))
    (swap-selected-elem! merge (e->scale e @transients))))

(defn resize-end [e]
  (when (:resizing (selected-elem))
    (swap-selected-elem! merge (e->scale e @transients) {:resizing false})
    (set-cursor! :auto)))

(defn debug-component []
  (if-not (empty? @debug)
    [:div
     [:div "Elem IDs: " (print-str (keys @elems))]
     [:span "debug"]
     (for [[prop v] @debug]
       [:div {:key prop}
        [:span (name prop) ": "]
        [:span (str v)]])]))

(defmulti render-elem :type)

(defn art-path [{:keys [d scale x y color color-preview outline-color id url] :as elem}]
  [:g
   (cond d
         (if (coll? d)
           (for [[idx segment] (map-indexed vector d)]
             ^{:key idx} [:path {:fill (or color-preview color)
                                 :stroke (or outline-color color-preview color)
                                 :d segment
                                 :transform (transform-matrix-str elem)}])
           [:path {:fill (or color-preview color)
                   :stroke (or outline-color color-preview color)
                   :d d
                   :transform (transform-matrix-str elem)}])
         url
         [:image {:width 100 :height 100 :xlink-href url :transform (transform-matrix-str elem)}])])

(declare -bounding-box)
(defn -center-art
  "Adjust transform to make (x,y) the central point"
  [this]
  (let [{:keys [x y width height]} (-bounding-box this)
        {:keys [scale]} (reagent/props this)]
    (doseq [path (children (reagent/dom-node this))]
      (.setAttribute path "transform"
                     (transform-matrix-str {:scale (or scale 1)
                                            :x (- x (/ width 2))
                                            :y (- y (/ height 2))})))))

(defmethod render-elem :art
  [elem]
  [(with-meta art-path
    {:component-did-mount -center-art
     :component-did-update -center-art})
   elem])

(defmethod render-elem :text
  [{:keys [type color color-preview x y outline-color
           font font-preview font-size text]}]
  [:text {:fill (or color-preview color)
          :stroke (or outline-color color-preview color)
          :x x
          :y y
          :text-anchor "middle"
          :style {:font-family (font->font-family-str (or font-preview font))
                  :font-size font-size}}
   [:tspan text]])

(defmethod render-elem :default
  [{:keys [x y]}]
  [:text {:x x :y y} "INVALID TYPE"])

(defn rect-component []
  (let [this (reagent/current-component)
        {id :id :as elem} (reagent/props this)]
    [:g {:key id
         :id (str "elem-" id)
         :on-mouse-down (fn [e]
                          (.preventDefault e)
                          (.stopPropagation e)
                          (reset! selected id)
                          (drag-start e))
         :pointer-events "boundingBox" ; doesn't work
         :on-mouse-up (fn [e] (drag-end e))
         :on-mouse-over (fn [e] (reset! highlighted id))
         :on-mouse-out (fn [e] (reset! highlighted nil))}
     (render-elem elem)]))

(defn -bounding-box [this]
  (let [bb (.getBBox (reagent/dom-node this))]
    {:x (.-x bb) :y (.-y bb) :width (.-width bb) :height (.-height bb)}))

(defn -update-bounding-box [this]
  (let [{:keys [id dragging resizing]} (reagent/props this)]
    (when-not (or dragging resizing)
      (swap! bounding-boxes assoc id (-bounding-box this)))))

(def rect-component-with-meta
  (with-meta rect-component
    {:component-did-mount -update-bounding-box
     :component-did-update -update-bounding-box}))

(defn drag-button []
  (let [move (async/tap (get-mult :mouse-move) (chan))
        up (async/tap (get-mult :mouse-up) (chan))]
    (go (while true
          (alt! move ([e] (drag-move e))
                up ([e] (drag-end e)))))
    (fn [bb]
      [:image {:key "drag-button"
               :on-mouse-down (fn [e]
                                (.preventDefault e)
                                (.stopPropagation e)
                                (drag-start e))

               :on-mouse-up (fn [e] (drag-end e))

               :xlink-href "drag.png"

               :x (- (:x bb) 20)
               :y (- (:y bb) 20)
               :height 20 :width 20}])))

(defn resize-button []
  (let [move (async/tap (get-mult :mouse-move) (chan))
        up (async/tap (get-mult :mouse-up) (chan))]
    (go (while true
          (alt! move ([e] (resize-move e))
                up ([e] (resize-end e)))))
    (fn [bb]
      [:image {:key "resize-button"
               :on-mouse-down (fn [e]
                                (.preventDefault e)
                                (.stopPropagation e)
                                (resize-start e))

               :on-mouse-up (fn [e] (resize-end e))

               :xlink-href "scale.png"

               :x (+ (:x bb) (:width bb))
               :y (+ (:y bb) (:height bb))
               :height 20 :width 20}])))

(defn delete-button [bb]
  [:image {:key "delete-button"
           :style {:cursor "pointer"}
           :on-mouse-down (fn [e]
                            (.preventDefault e)
                            (.stopPropagation e)
                            (delete-elem! @selected))

           :xlink-href "delete.png"

           :x (- (:x bb) 20)
           :y (+ (:y bb) (:height bb))
           :height 20 :width 20}])

(defn rotate-button [bb]
  [:image {:key "rotate-button"
           :on-mouse-down (fn [e]
                            (.preventDefault e)
                            (.stopPropagation e)
                                        ; nop
                            )

           :xlink-href "rotate.png"

           :x (+ (:x bb) (:width bb))
           :y (- (:y bb) 20)
           :height 20 :width 20}])

(defn controls-component []
  (fn [bounding-box]
    [:g
     [:rect (merge bounding-box
                   {:fill :none
                    :stroke-dasharray "4,3"
                    :stroke "#000000"})]
     [drag-button bounding-box]
     [resize-button bounding-box]
     [delete-button bounding-box]
     [rotate-button bounding-box]]))

(defn highlight-box [bb]
  [:rect (merge bb {:fill :none :stroke "#000000"})])

(defn text-field []
  [:div {:class "form-group"}
   [:input {:type "text" :placeholder "Add your text here"
            :class "form-control input-lg"
            :style {:width "300px"}
            :on-change (fn [e]
                         (swap! options assoc :text-field (.. e -target -value))
                         (put! (get-channel :text-change) (.. e -target -value)))
            :value (:text (selected-elem) "")}]])

(def text-field-with-meta
  (with-meta text-field
    {:component-will-mount
     (fn []
       (go (let [text-change (async/tap (get-mult :text-change) (chan))
                 selection-change (async/tap (get-mult :selection-change) (chan))]
             (while true
               (alt! text-change
                     ([v] (if @selected
                            (swap-selected-elem! assoc :text v)
                            (create-elem! (merge @default-elem-props
                                                 @default-text-elem-props
                                                 {:text v}))))
                     selection-change
                     ([_]
                        (swap! options assoc
                               :text-field (:text (selected-elem)))))))))}))

(def fudge [10 1])

(defn shirt-img [filename x-offset]
  (let [[width height] (get-in config [:shirt-dimensions])
        shirt-color (:shirt-color-preview @options)
        [fudge-x fudge-y] fudge]
   [:g
    [:rect {:class "shirt-background"
            :stroke shirt-color
            :fill shirt-color
            :x (+ x-offset fudge-x)
            :width (- width (* 2 fudge-x))
            :height (- height (* 2 fudge-y))}]
    [:image {:xlink-href filename
             :x x-offset
             :width width
             :height height}]]))

(defn shirts []
  (let [width (get-in config [:shirt-dimensions 0])
        canvas-width (get-in config [:canvas-width])]
    [:g {:key "shirts"}
     (shirt-img "shirt.png" (- (/ canvas-width 4) (/ width 2)))
     (shirt-img "shirt-back.png" (- canvas-width (/ canvas-width 4) (/ width 2)))]))

(defn shirt-color-selection [[color title]]
  [:li {:class "color-selection"
        :style {:background color}
        :on-mouse-down (fn [_]
                         (swap! options assoc
                                :shirt-color color
                                :shirt-color-preview color))
        :on-mouse-over (fn [_]
                         (swap! options assoc
                                :shirt-color-preview color))
        :on-mouse-out (fn [_]
                        (swap! options assoc
                               :shirt-color-preview (:shirt-color @options)))}])

(defn shirt-color-selector []
  [:ul {:class "shirt-color-selector color-selector"
        :style {:position "absolute"
                :bottom "80px"
                :left (str (- (/ (get-in config [:canvas-width]) 2) 12) "px")}}
   (for [[color title :as s] (:shirt-colors config)]
     ^{:key color} [shirt-color-selection s])])

;; elem-color-selection
(defn color-selection [color]
  [:li {:class "elem-color-selection color-selection"
        :style {:background color}
        :on-mouse-over (fn [_]
                         (when @selected
                           (swap-selected-elem! assoc :color-preview color)))
        :on-click (fn [_]
                    (if @selected
                      (swap-selected-elem! assoc :color color)
                      (swap! default-elem-props assoc :color color)))
        :on-mouse-out (fn [_]
                        (when @selected
                          (swap-selected-elem! dissoc :color-preview)))}])

;; elem-color-selector
(defn color-selector []
  [:div {:class "form-group"}
   [:div {:class "btn-group dropup"}
    [:button {:type "button"
              :class "btn btn-default btn-lg dropdown-toggle"
              :data-toggle "dropdown"}
     [:div {:id "color-selector-label"}
      [:div {:class "color-selection"
             :style {:display "inline-block"
                     :margin "2px 0 -2px 0"
                     :background (or (:color (selected-elem))
                                     (:color @default-elem-props))}}]
      [:span.caret.with-margin]]]
    [:ul {:class "dropdown-menu elem-color-selector color-selector" :role "menu"}
     (for [c (:elem-colors config)] ^{:key c} [color-selection c])]]])

(defn font-selection [[font style :as f]]
  [:li {:class ""
        :role "presentation"
        :style {:font-family (font->font-family-str f)}
        }
   [:a {:role "menuitem"
        :on-mouse-over (fn [_]
                         (when @selected
                           (swap-selected-elem! assoc :font-preview f)))
        :on-click (fn [e]
                    (.preventDefault e)
                    (if @selected
                      (swap-selected-elem! assoc :font f)
                      (swap! default-text-elem-props assoc :font f)))
        :on-mouse-out (fn [_]
                        (when @selected
                          (swap-selected-elem! dissoc :font-preview)))} font]])

(defn font-selector []
  [:div {:class "form-group"}
   [:div {:class "btn-group dropup" :style {:height "46px"}}
    [:button {:type "button"
              :class "btn btn-default btn-lg dropdown-toggle"
              :data-toggle "dropdown"}
     (let [[font-name _ :as displayed-font] (or (:font (selected-elem))
                                                (:font @default-text-elem-props))]
       [:div {:class "font-selection"
              :id "font-selector-label"
              :style {:display "inline-block"
                      :font-family (font->font-family-str displayed-font)
                      :margin 0}}
        font-name
        [:span.caret.with-margin]])]
    [:ul {:class "dropdown-menu font-selector"
          :role "menu"
          :aria-labelledby "font-selector-label"}
     (for [[font-name :as f] (:fonts config)] ^{:key font-name} [font-selection f])]]])

(defn switcher []
  [:div {:class "form-group right-align-group"}
   [:div {:class "btn btn-default btn-lg"
          :on-click (fn [e]
                      (reset! active-options
                              (case @active-options :text :art :art :text))
                      (reset! selected nil))}
    (case @active-options :text "Add art" :art "Add text")]])

(defn text-options []
  [:form {:id "options" :class "form-inline"}
   [text-field-with-meta]
   [color-selector]
   [font-selector]
   [switcher]])

(defn art-selection [art]
  [:li {:class "inline-block-selection"
        :role "presentation"}
   [:a {:role "menuitem"
        :class "inline-block-selection-link"
        :on-click (fn [e]
                    (.preventDefault e)
                    (create-elem! (merge @default-elem-props
                                         @default-art-elem-props
                                         art)))}
    [:svg (render-elem (merge art {:type :art :color (:color @default-elem-props) :x 75 :y 75}))]]])

(defn art-selector []
  [:div {:class "form-group"}
   [:div {:class "btn-group dropup" :style {:height "46px"}}
    [:button {:type "button"
              :class "btn btn-default btn-lg dropdown-toggle"
              :data-toggle "dropdown"}
     (let [a 1]
       [:div {:id "art-selector-label"
              :style {:display "inline-block"
                      :margin 0}}
        "Add art"
        [:span.caret.with-margin]])]
    [:ul {:class "dropdown-menu art-selector"
          :role "menu"
          :aria-labelledby "art-selector-label"}
     (for [[idx a] (map-indexed #(vector %1 %2) (:art config))]
       ^{:key idx} [art-selection (assoc a :art-id idx)])]]])

(defn art-options []
  [:form {:id "options" :class "form-inline"}
   [art-selector]
   [color-selector]
   [switcher]
   [:div.form-group [:span "Add art from the library or drag an image onto the page."]]])

(defn options-component []
  (case @active-options :text (text-options) :art (art-options)))

(defn canvas-component []
  [:div {:id "the-editor"}
   [:div {:style {:display :inline-block}}
    [:svg {:width (:canvas-width config) :height (:canvas-height config)
           :on-mouse-down (fn [e] (reset! selected nil))
           :class "unselectable"}
     ^{:key "shirts"} [shirts]
     (for [[id elem] @elems]
       ^{:key (str "elem-" id)} [rect-component-with-meta (assoc elem :id id)])
     (when (and @highlighted (not= @selected @highlighted))
       (when-not (when-let [{:keys [dragging resizing]} (selected-elem)]
                   (or dragging resizing))
         (when-let [bb (@bounding-boxes @highlighted)] [highlight-box bb])))
     (when-let [{:keys [id dragging resizing]} (selected-elem)]
       (when-let [bb (@bounding-boxes id)]
         (when-not (or dragging resizing)
           [controls-component bb])))]]
   [options-component]
   [shirt-color-selector]])

(defn route-event-to-channel! [event-type channel-name &
                               [{:keys [prevent-default?] :as opts}]]
  (js/window.addEventListener (name event-type)
                              (fn [e]
                                (when prevent-default? (.preventDefault e))
                                (put! (get-channel channel-name) e))))

(defn init-events! []
  (route-event-to-channel! :mousedown :mouse-down)
  (route-event-to-channel! :mouseup :mouse-up)
  (route-event-to-channel! :mousemove :mouse-move)

  (route-event-to-channel! :dragover :file-drag-over {:prevent-default? true})
  (route-event-to-channel! :dragleave :file-drag-leave {:prevent-default? true})
  (route-event-to-channel! :dragend :file-drag-end {:prevent-default? true})
;  (route-event-to-channel! :drop :file-drop {:prevent-default? true}) channel doesn't convey file

  (js/window.addEventListener "keydown"
                              (fn [e] (case (.-keyCode e)
                                        13
                                        (do (.preventDefault e)
                                            (println "Prevented form submission"))
                                        8
                                        (when (not= "text" (aget e "target" "type"))
                                          (.preventDefault e)
                                          (when @selected
                                            (delete-elem! @selected)))
                                        #_(println "Key pressed: " (.-keyCode e))
                                        :nop)))

  (js/window.addEventListener "drop"
                              (fn [e]
                                (.preventDefault e)
                                (set-visible! :drop-note false)
                                (let [files (js-to-list (aget e "dataTransfer" "files"))
                                      file (get files 0)
                                      reader (js/FileReader.)]
                                  (aset reader "onload" #(put! (get-channel :file-loaded) %))
                                  (.readAsDataURL reader file))))

  (add-watch selected :selection-change
             (fn [k r o n]
               (when-not (= o n)
                 (put! (get-channel :selection-change)
                       {:old o
                        :new n}))))

  (let [text-change (async/tap (get-mult :text-change) (chan))
        selection-change (async/tap (get-mult :selection-change) (chan))
        file-drag-over (async/tap (get-mult :file-drag-over) (chan))
        file-drag-leave (async/tap (get-mult :file-drag-leave) (chan))
        file-drag-end (async/tap (get-mult :file-drag-end) (chan))
        file-loaded (async/tap (get-mult :file-loaded) (chan))]
      (go (while true
            (alt! text-change
                  ([v]
                   (swap! debug assoc :text v))
                  selection-change
                  ([{:keys [old new]}]
                     ;(swap! debug assoc :selection-old old :selection-new new)
                     (reset! debug (dissoc (selected-elem) :d :url))
                     (when (= old @highlighted) (reset! highlighted nil))
                     (when (and (not (nil? new))
                                (not= (:type (selected-elem)) @active-options))
                       (reset! active-options (:type (selected-elem)))))
                  file-drag-over
                  ([e] (.preventDefault e) (set-visible! :drop-note true))
                  file-drag-leave
                  ([e] (.preventDefault e)
                     (set-visible! :drop-note false))
                  file-drag-end
                  ([e] (.preventDefault e)
                     (set-visible! :drop-note false))
                  file-loaded
                  ([e]
                   (create-elem! (merge @default-elem-props @default-art-elem-props
                                        {:url (aget e "target" "result")}))))))))


(defn init! []
  (init-events!)

  (reagent/render-component [canvas-component] (get-element "editor"))
  (reagent/render-component [debug-component] (get-element "debug"))

  (println "Initialized"))

(aset js/window "onload" init!)
